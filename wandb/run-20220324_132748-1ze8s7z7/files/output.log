Found 4 GPUs for rendering. Using device 0.
Found 4 GPUs for rendering. Using device 0.
Found 4 GPUs for rendering. Using device 0.
Using cpu device
Wrapping the env in a VecTransposeImage.
envs and model setup in 5.5418
starting to learn
-------------reset----------------
-------------reset----------------
-------------reset----------------
Logging to runs/1ze8s7z7/test_1
----------------------------
| time/              |     |
|    fps             | 67  |
|    iterations      | 1   |
|    time_elapsed    | 8   |
|    total_timesteps | 600 |
----------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 400        |
|    ep_rew_mean          | 6.8        |
| time/                   |            |
|    fps                  | 21         |
|    iterations           | 2          |
|    time_elapsed         | 54         |
|    total_timesteps      | 1200       |
| train/                  |            |
|    approx_kl            | 0.01238349 |
|    clip_fraction        | 0.105      |
|    clip_range           | 0.2        |
|    entropy_loss         | -11.3      |
|    explained_variance   | -0.0401    |
|    learning_rate        | 0.0003     |
|    loss                 | 0.246      |
|    n_updates            | 10         |
|    policy_gradient_loss | -0.00603   |
|    std                  | 0.996      |
|    value_loss           | 1.19       |
----------------------------------------
training done
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 400          |
|    ep_rew_mean          | 6.8          |
| time/                   |              |
|    fps                  | 18           |
|    iterations           | 3            |
|    time_elapsed         | 94           |
|    total_timesteps      | 1800         |
| train/                  |              |
|    approx_kl            | 0.0078840405 |
|    clip_fraction        | 0.102        |
|    clip_range           | 0.2          |
|    entropy_loss         | -11.3        |
|    explained_variance   | 0.132        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.01        |
|    n_updates            | 20           |
|    policy_gradient_loss | -0.00886     |
|    std                  | 0.992        |
|    value_loss           | 0.00601      |
------------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.84        |
| time/                   |             |
|    fps                  | 17          |
|    iterations           | 4           |
|    time_elapsed         | 136         |
|    total_timesteps      | 2400        |
| train/                  |             |
|    approx_kl            | 0.011020013 |
|    clip_fraction        | 0.0825      |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.3       |
|    explained_variance   | -1.19e-06   |
|    learning_rate        | 0.0003      |
|    loss                 | 0.192       |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.00556    |
|    std                  | 0.99        |
|    value_loss           | 0.485       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.84        |
| time/                   |             |
|    fps                  | 17          |
|    iterations           | 5           |
|    time_elapsed         | 172         |
|    total_timesteps      | 3000        |
| train/                  |             |
|    approx_kl            | 0.006280756 |
|    clip_fraction        | 0.0893      |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.3       |
|    explained_variance   | 6.41e-05    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.000367   |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.00838    |
|    std                  | 0.988       |
|    value_loss           | 0.00039     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.7         |
| time/                   |             |
|    fps                  | 16          |
|    iterations           | 6           |
|    time_elapsed         | 215         |
|    total_timesteps      | 3600        |
| train/                  |             |
|    approx_kl            | 0.025579602 |
|    clip_fraction        | 0.206       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 1.48e-05    |
|    learning_rate        | 0.0003      |
|    loss                 | 0.232       |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0134     |
|    std                  | 0.986       |
|    value_loss           | 0.413       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.7         |
| time/                   |             |
|    fps                  | 16          |
|    iterations           | 7           |
|    time_elapsed         | 255         |
|    total_timesteps      | 4200        |
| train/                  |             |
|    approx_kl            | 0.012188391 |
|    clip_fraction        | 0.182       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 0.298       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0195     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0165     |
|    std                  | 0.984       |
|    value_loss           | 0.00017     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 400       |
|    ep_rew_mean          | 6.57      |
| time/                   |           |
|    fps                  | 15        |
|    iterations           | 8         |
|    time_elapsed         | 301       |
|    total_timesteps      | 4800      |
| train/                  |           |
|    approx_kl            | 0.0224377 |
|    clip_fraction        | 0.193     |
|    clip_range           | 0.2       |
|    entropy_loss         | -11.2     |
|    explained_variance   | -3.58e-07 |
|    learning_rate        | 0.0003    |
|    loss                 | 0.187     |
|    n_updates            | 70        |
|    policy_gradient_loss | -0.0104   |
|    std                  | 0.981     |
|    value_loss           | 0.358     |
---------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.57        |
| time/                   |             |
|    fps                  | 15          |
|    iterations           | 9           |
|    time_elapsed         | 354         |
|    total_timesteps      | 5400        |
| train/                  |             |
|    approx_kl            | 0.006349093 |
|    clip_fraction        | 0.0917      |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 1.85e-06    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0157     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0045     |
|    std                  | 0.979       |
|    value_loss           | 0.000265    |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 400        |
|    ep_rew_mean          | 6.47       |
| time/                   |            |
|    fps                  | 15         |
|    iterations           | 10         |
|    time_elapsed         | 396        |
|    total_timesteps      | 6000       |
| train/                  |            |
|    approx_kl            | 0.01794537 |
|    clip_fraction        | 0.148      |
|    clip_range           | 0.2        |
|    entropy_loss         | -11.2      |
|    explained_variance   | 0          |
|    learning_rate        | 0.0003     |
|    loss                 | 0.0883     |
|    n_updates            | 90         |
|    policy_gradient_loss | -0.00719   |
|    std                  | 0.977      |
|    value_loss           | 0.358      |
----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.47        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 11          |
|    time_elapsed         | 450         |
|    total_timesteps      | 6600        |
| train/                  |             |
|    approx_kl            | 0.010234172 |
|    clip_fraction        | 0.161       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | -5.96e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0238     |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0123     |
|    std                  | 0.978       |
|    value_loss           | 0.00106     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.51        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 12          |
|    time_elapsed         | 493         |
|    total_timesteps      | 7200        |
| train/                  |             |
|    approx_kl            | 0.011397287 |
|    clip_fraction        | 0.126       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 0.22        |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.00752    |
|    std                  | 0.979       |
|    value_loss           | 0.467       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.51        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 13          |
|    time_elapsed         | 540         |
|    total_timesteps      | 7800        |
| train/                  |             |
|    approx_kl            | 0.009687458 |
|    clip_fraction        | 0.054       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 5.96e-08    |
|    learning_rate        | 0.0003      |
|    loss                 | 0.012       |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.00345    |
|    std                  | 0.98        |
|    value_loss           | 0.00215     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.59        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 14          |
|    time_elapsed         | 588         |
|    total_timesteps      | 8400        |
| train/                  |             |
|    approx_kl            | 0.016549163 |
|    clip_fraction        | 0.104       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.36        |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.00608    |
|    std                  | 0.979       |
|    value_loss           | 0.535       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.59        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 15          |
|    time_elapsed         | 633         |
|    total_timesteps      | 9000        |
| train/                  |             |
|    approx_kl            | 0.014123878 |
|    clip_fraction        | 0.124       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00135    |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.00606    |
|    std                  | 0.979       |
|    value_loss           | 0.00339     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.53        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 16          |
|    time_elapsed         | 677         |
|    total_timesteps      | 9600        |
| train/                  |             |
|    approx_kl            | 0.020863473 |
|    clip_fraction        | 0.126       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.113       |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.00826    |
|    std                  | 0.98        |
|    value_loss           | 0.356       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.53        |
| time/                   |             |
|    fps                  | 14          |
|    iterations           | 17          |
|    time_elapsed         | 728         |
|    total_timesteps      | 10200       |
| train/                  |             |
|    approx_kl            | 0.010153715 |
|    clip_fraction        | 0.13        |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 1.79e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00583    |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.00792    |
|    std                  | 0.978       |
|    value_loss           | 0.00331     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.52        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 18          |
|    time_elapsed         | 773         |
|    total_timesteps      | 10800       |
| train/                  |             |
|    approx_kl            | 0.009047814 |
|    clip_fraction        | 0.0868      |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0978      |
|    n_updates            | 170         |
|    policy_gradient_loss | -0.00659    |
|    std                  | 0.977       |
|    value_loss           | 0.413       |
-----------------------------------------
training done
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.52        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 19          |
|    time_elapsed         | 819         |
|    total_timesteps      | 11400       |
| train/                  |             |
|    approx_kl            | 0.011373785 |
|    clip_fraction        | 0.101       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | 5.96e-08    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0102     |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.00698    |
|    std                  | 0.978       |
|    value_loss           | 0.00412     |
-----------------------------------------
training done
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
episode _FINISHED
-------------reset----------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 400         |
|    ep_rew_mean          | 6.53        |
| time/                   |             |
|    fps                  | 13          |
|    iterations           | 20          |
|    time_elapsed         | 860         |
|    total_timesteps      | 12000       |
| train/                  |             |
|    approx_kl            | 0.015849324 |
|    clip_fraction        | 0.089       |
|    clip_range           | 0.2         |
|    entropy_loss         | -11.2       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 0.138       |
|    n_updates            | 190         |
|    policy_gradient_loss | -0.00507    |
|    std                  | 0.978       |
|    value_loss           | 0.467       |
-----------------------------------------
training done
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 400          |
|    ep_rew_mean          | 6.53         |
| time/                   |              |
|    fps                  | 13           |
|    iterations           | 21           |
|    time_elapsed         | 904          |
|    total_timesteps      | 12600        |
| train/                  |              |
|    approx_kl            | 0.0075856284 |
|    clip_fraction        | 0.0913       |
|    clip_range           | 0.2          |
|    entropy_loss         | -11.2        |
|    explained_variance   | -2.38e-07    |
|    learning_rate        | 0.0003       |
|    loss                 | -0.00508     |
|    n_updates            | 200          |
|    policy_gradient_loss | -0.00585     |
|    std                  | 0.976        |
|    value_loss           | 0.00467      |
------------------------------------------
Process ForkServerProcess-4:
Traceback (most recent call last):
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 27, in _worker
    cmd, data = remote.recv()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Process ForkServerProcess-3:
Process ForkServerProcess-2:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 27, in _worker
    cmd, data = remote.recv()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 27, in _worker
    cmd, data = remote.recv()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Traceback (most recent call last):
  File "test_train_model_local_multi.py", line 103, in <module>
    model.learn(total_timesteps = 400*3*8*5, log_interval= 1, tb_log_name="test",)
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/ppo/ppo.py", line 299, in learn
    return super(PPO, self).learn(
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 270, in learn
    self.train()
  File "/home/ludvik/anaconda3/envs/RS_SB3_test/lib/python3.8/site-packages/stable_baselines3/ppo/ppo.py", line 259, in train
    loss.backward()
  File "/home/ludvik/.local/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/ludvik/.local/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt